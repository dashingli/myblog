(function(t){function e(e){for(var n,o,r=e[0],c=e[1],l=e[2],d=0,m=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);p&&p(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,r=1;r<a.length;r++){var c=a[r];0!==s[c]&&(n=!1)}n&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},s={app:0},i=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/myblog/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var p=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0087":function(t,e,a){},"00c8":function(t,e,a){},"0464":function(t,e,a){},"0bb0":function(t,e,a){"use strict";a("0087")},"0c19":function(t,e,a){},"0f35":function(t,e,a){},"17dd":function(t,e,a){"use strict";a("00c8")},"1b18":function(t,e,a){"use strict";a("3abc")},"27b7":function(t,e,a){"use strict";a("bfad")},"3abc":function(t,e,a){},"3b9e":function(t,e,a){"use strict";a("6e81")},4045:function(t,e,a){t.exports=a.p+"img/loading.6cc04d10.svg"},4174:function(t,e,a){t.exports=a.p+"img/default.969421d9.gif"},"42a1":function(t,e,a){"use strict";a("a2e8")},"463f":function(t,e,a){t.exports=a.p+"img/404.591a87d0.gif"},4700:function(t,e,a){},"4bba":function(t,e,a){},"536b":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var n=a("96eb"),s=a.n(n);s.a.mock("/api/banner","get",{code:0,msg:"",data:[{id:"2",midImg:s.a.Random.dataImage("200x100","Hello 这是李林哲的个人博客!"),bigImg:s.a.Random.dataImage("500x600","Hello 这是李林哲的个人博客!"),title:"每天进步一点点",description:"让自己变得更加强大"},{id:"3",midImg:s.a.Random.dataImage("200x100","Hello Python!"),bigImg:s.a.Random.dataImage("500x600","Hello Python!"),title:"学如逆水行舟",description:"不进则退"},{id:"4",midImg:s.a.Random.dataImage("200x100","Hello JavaScript!"),bigImg:s.a.Random.dataImage("500x600","Hello JavaScript!"),title:"一步一个脚印",description:"fighting!!"}]});var i=a("b383"),o=a.n(i);s.a.mock("/api/blogtype","get",{code:0,msg:"","data|10-20":[{"id|+1":1,name:"分类@id","articleCount|0-300":0,"order|+1":1}]}),s.a.mock(/^\/api\/blog(\?.+)?$/,"get",(function(t){const e=o.a.parse(t.url),a={"total|2000-3000":0,["rows|0-"+e.limit]:[{id:"@guid",title:"@ctitle",description:"@cparagraph(1, 10)",category:{"id|1-10":0,name:"分类@id"},"scanNumber|0-3000":0,"commentNumber|0-300":30,"thumb|1":["@image(300x250, @color, #fff, @natural)"],createDate:"@date('T')"}]};return s.a.mock({code:0,msg:"",data:a})})),s.a.mock(/^\/api\/blog\/(\d|\w|-)+$/,"get",{code:0,msg:"",data:{id:"@guid",title:"CORS跨域方案详解",category:{"id|1-10":1,name:"分类@id"},description:"@cparagraph(1, 10)","scanNumber|0-10000":0,"commentNumber|0-100":0,createDate:"@date('T')",toc:[{name:"概述",anchor:"article-md-title-1"},{name:"简单请求",anchor:"article-md-title-2",children:[{name:"简单请求的判定",anchor:"article-md-title-3"},{name:"简单请求的交互规范",anchor:"article-md-title-4"}]},{name:"需要预检的请求",anchor:"article-md-title-5"},{name:"附带身份凭证的请求",anchor:"article-md-title-6"},{name:"一个额外的补充",anchor:"article-md-title-7"}],"thumb|1":[s.a.Random.image("300x250","#000","#fff","Random Image"),null],htmlContent:'<blockquote>\n  <p>阅读本文，你需要首先知道：</p><ol>\n  <li>浏览器的同源策略</li>\n  <li>跨域问题</li>\n  <li>JSONP原理</li>\n  <li>cookie原理</li>\n  </ol>\n  </blockquote>\n  <p>JSONP并不是一个好的跨域解决方案，它至少有着下面两个严重问题：</p><ol>\n  <li><strong>会打乱服务器的消息格式</strong>：JSONP要求服务器响应一段JS代码，但在非跨域的情况下，服务器又需要响应一个正常的JSON格式</li>\n  <li><strong>只能完成GET请求</strong>：JSONP的原理会要求浏览器端生成一个<code>script</code>元素，而<code>script</code>元素发出的请求只能是<code>get</code>请求</li>\n  </ol>\n  <p>所以，CORS是一种更好的跨域解决方案。</p><h1 id="article-md-title-1">概述</h1><p><code>CORS</code>是基于<code>http1.1</code>的一种跨域解决方案，它的全称是<strong>C</strong>ross-<strong>O</strong>rigin <strong>R</strong>esource <strong>S</strong>haring，跨域资源共享。</p><p>它的总体思路是：<strong>如果浏览器要跨域访问服务器的资源，需要获得服务器的允许</strong></p><figure class="markdown-image">\n        \n        <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421152122793.png" title="image-20200421152122793" alt="image-20200421152122793">\n        <figcaption>image-20200421152122793</figcaption>\n    \n      </figure><p>而要知道，一个请求可以附带很多信息，从而会对服务器造成不同程度的影响</p><p>比如有的请求只是获取一些新闻，有的请求会改动服务器的数据</p><p>针对不同的请求，CORS规定了三种不同的交互模式，分别是：</p><ul>\n  <li><strong>简单请求</strong></li>\n  <li><strong>需要预检的请求</strong></li>\n  <li><strong>附带身份凭证的请求</strong></li>\n  </ul>\n  <p>这三种模式从上到下层层递进，请求可以做的事越来越多，要求也越来越严格。</p><p>下面分别说明三种请求模式的具体规范。</p><h1 id="article-md-title-2">简单请求</h1><p>当浏览器端运行了一段ajax代码（无论是使用XMLHttpRequest还是fetch api），浏览器会首先判断它属于哪一种请求模式</p><h2 id="article-md-title-3">简单请求的判定</h2><p>当请求<strong>同时满足</strong>以下条件时，浏览器会认为它是一个简单请求：</p><ol>\n  <li><p><strong>请求方法属于下面的一种：</strong></p><ul>\n  <li>get</li>\n  <li>post</li>\n  <li>head</li>\n  </ul>\n  </li>\n  <li><p><strong>请求头仅包含安全的字段，常见的安全字段如下：</strong></p><ul>\n  <li><code>Accept</code></li>\n  <li><code>Accept-Language</code></li>\n  <li><code>Content-Language</code></li>\n  <li><code>Content-Type</code></li>\n  <li><code>DPR</code></li>\n  <li><code>Downlink</code></li>\n  <li><code>Save-Data</code></li>\n  <li><code>Viewport-Width</code></li>\n  <li><code>Width</code></li>\n  </ul>\n  </li>\n  <li><p><strong>请求头如果包含<code>Content-Type</code>，仅限下面的值之一：</strong></p><ul>\n  <li><code>text/plain</code></li>\n  <li><code>multipart/form-data</code></li>\n  <li><code>application/x-www-form-urlencoded</code></li>\n  </ul>\n  </li>\n  </ol>\n  <p>如果以上三个条件同时满足，浏览器判定为简单请求。</p><p>下面是一些例子：</p><pre><code class="language-js"><span class="hljs-comment">// 简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>);\n  \n  <span class="hljs-comment">// 请求方法不满足要求，不是简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n    <span class="hljs-attr">method</span>:<span class="hljs-string">"PUT"</span>\n  })\n  \n  <span class="hljs-comment">// 加入了额外的请求头，不是简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n    <span class="hljs-attr">headers</span>:{\n      <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>\n    }\n  })\n  \n  <span class="hljs-comment">// 简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n    <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>\n  })\n  \n  <span class="hljs-comment">// content-type不满足要求，不是简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>, {\n    <span class="hljs-attr">method</span>: <span class="hljs-string">"post"</span>,\n    <span class="hljs-attr">headers</span>: {\n      <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>\n    }\n  })</code></pre>\n  <h2 id="article-md-title-4">简单请求的交互规范</h2><p>当浏览器判定某个<strong>ajax跨域请求</strong>是<strong>简单请求</strong>时，会发生以下的事情</p><ol>\n  <li><strong>请求头中会自动添加<code>Origin</code>字段</strong></li>\n  </ol>\n  <p>比如，在页面<code>http://my.com/index.html</code>中有以下代码造成了跨域</p><pre><code class="language-js"><span class="hljs-comment">// 简单请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/news"</span>);</code></pre>\n  <p>请求发出后，请求头会是下面的格式：</p><pre><code>GET /api/news/ HTTP/1.1\n  Host: crossdomain.com\n  Connection: keep-alive\n  ...\n  Referer: http://my.com/index.html\n  Origin: http://my.com</code></pre><p>看到最后一行没，<code>Origin</code>字段会告诉服务器，是哪个源地址在跨域请求</p><ol start="2">\n  <li><strong>服务器响应头中应包含<code>Access-Control-Allow-Origin</code></strong></li>\n  </ol>\n  <p>当服务器收到请求后，如果允许该请求跨域访问，需要在响应头中添加<code>Access-Control-Allow-Origin</code>字段</p><p>该字段的值可以是：</p><ul>\n  <li>*：表示我很开放，什么人我都允许访问</li>\n  <li>具体的源：比如<code>http://my.com</code>，表示我就允许你访问</li>\n  </ul>\n  <blockquote>\n  <p>实际上，这两个值对于客户端<code>http://my.com</code>而言，都一样，因为客户端才不会管其他源服务器允不允许，就关心自己是否被允许</p><p>当然，服务器也可以维护一个可被允许的源列表，如果请求的<code>Origin</code>命中该列表，才响应<code>*</code>或具体的源</p><p><strong>为了避免后续的麻烦，强烈推荐响应具体的源</strong></p></blockquote>\n  <p>假设服务器做出了以下的响应：</p><pre><code>HTTP/1.1 200 OK\n  Date: Tue, 21 Apr 2020 08:03:35 GMT\n  ...\n  Access-Control-Allow-Origin: http://my.com\n  ...\n  \n  消息体中的数据</code></pre><p>当浏览器看到服务器允许自己访问后，高兴的像一个两百斤的孩子，于是，它就把响应顺利的交给js，以完成后续的操作</p><p>下图简述了整个交互过程</p><figure class="markdown-image">\n        \n        <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421162846480.png" title="image-20200421162846480" alt="image-20200421162846480">\n        <figcaption>image-20200421162846480</figcaption>\n    \n      </figure><h1 id="article-md-title-5">需要预检的请求</h1><p>简单的请求对服务器的威胁不大，所以允许使用上述的简单交互即可完成。</p><p>但是，如果浏览器不认为这是一种简单请求，就会按照下面的流程进行：</p><ol>\n  <li><strong>浏览器发送预检请求，询问服务器是否允许</strong></li>\n  <li><strong>服务器允许</strong></li>\n  <li><strong>浏览器发送真实请求</strong></li>\n  <li><strong>服务器完成真实的响应</strong></li>\n  </ol>\n  <p>比如，在页面<code>http://my.com/index.html</code>中有以下代码造成了跨域</p><pre><code class="language-js"><span class="hljs-comment">// 需要预检的请求</span>\n  fetch(<span class="hljs-string">"http://crossdomain.com/api/user"</span>, {\n    <span class="hljs-attr">method</span>:<span class="hljs-string">"POST"</span>, <span class="hljs-comment">// post 请求</span>\n    <span class="hljs-attr">headers</span>:{  <span class="hljs-comment">// 设置请求头</span>\n      <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,\n      <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,\n      <span class="hljs-string">"content-type"</span>: <span class="hljs-string">"application/json"</span>\n    },\n    <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">name</span>: <span class="hljs-string">"袁小进"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> }) <span class="hljs-comment">// 设置请求体</span>\n  });</code></pre>\n  <p>浏览器发现它不是一个简单请求，则会按照下面的流程与服务器交互</p><ol>\n  <li><strong>浏览器发送预检请求，询问服务器是否允许</strong></li>\n  </ol>\n  <pre><code>OPTIONS /api/user HTTP/1.1\n  Host: crossdomain.com\n  ...\n  Origin: http://my.com\n  Access-Control-Request-Method: POST\n  Access-Control-Request-Headers: a, b, content-type</code></pre><p>可以看出，这并非我们想要发出的真实请求，请求中不包含我们的响应头，也没有消息体。</p><p>这是一个预检请求，它的目的是询问服务器，是否允许后续的真实请求。</p><p>预检请求<strong>没有请求体</strong>，它包含了后续真实请求要做的事情</p><p>预检请求有以下特征：</p><ul>\n  <li>请求方法为<code>OPTIONS</code></li>\n  <li>没有请求体</li>\n  <li>请求头中包含<ul>\n  <li><code>Origin</code>：请求的源，和简单请求的含义一致</li>\n  <li><code>Access-Control-Request-Method</code>：后续的真实请求将使用的请求方法</li>\n  <li><code>Access-Control-Request-Headers</code>：后续的真实请求会改动的请求头</li>\n  </ul>\n  </li>\n  </ul>\n  <ol start="2">\n  <li><strong>服务器允许</strong></li>\n  </ol>\n  <p>服务器收到预检请求后，可以检查预检请求中包含的信息，如果允许这样的请求，需要响应下面的消息格式</p><pre><code>HTTP/1.1 200 OK\n  Date: Tue, 21 Apr 2020 08:03:35 GMT\n  ...\n  Access-Control-Allow-Origin: http://my.com\n  Access-Control-Allow-Methods: POST\n  Access-Control-Allow-Headers: a, b, content-type\n  Access-Control-Max-Age: 86400\n  ...</code></pre><p>对于预检请求，不需要响应任何的消息体，只需要在响应头中添加：</p><ul>\n  <li><code>Access-Control-Allow-Origin</code>：和简单请求一样，表示允许的源</li>\n  <li><code>Access-Control-Allow-Methods</code>：表示允许的后续真实的请求方法</li>\n  <li><code>Access-Control-Allow-Headers</code>：表示允许改动的请求头</li>\n  <li><code>Access-Control-Max-Age</code>：告诉浏览器，多少秒内，对于同样的请求源、方法、头，都不需要再发送预检请求了</li>\n  </ul>\n  <ol start="3">\n  <li><strong>浏览器发送真实请求</strong></li>\n  </ol>\n  <p>预检被服务器允许后，浏览器就会发送真实请求了，上面的代码会发生下面的请求数据</p><pre><code>POST /api/user HTTP/1.1\n  Host: crossdomain.com\n  Connection: keep-alive\n  ...\n  Referer: http://my.com/index.html\n  Origin: http://my.com\n  \n  {"name": "袁小进", "age": 18 }</code></pre><ol start="4">\n  <li><strong>服务器响应真实请求</strong></li>\n  </ol>\n  <pre><code>HTTP/1.1 200 OK\n  Date: Tue, 21 Apr 2020 08:03:35 GMT\n  ...\n  Access-Control-Allow-Origin: http://my.com\n  ...\n  \n  添加用户成功</code></pre><p>可以看出，当完成预检之后，后续的处理与简单请求相同</p><p>下图简述了整个交互过程</p><figure class="markdown-image">\n        \n        <img style="width:auto" src="http://mdrs.yuanjin.tech/img/image-20200421165913320.png" title="image-20200421165913320" alt="image-20200421165913320">\n        <figcaption>image-20200421165913320</figcaption>\n    \n      </figure><h1 id="article-md-title-6">附带身份凭证的请求</h1><p>默认情况下，ajax的跨域请求并不会附带cookie，这样一来，某些需要权限的操作就无法进行</p><p>不过可以通过简单的配置就可以实现附带cookie</p><pre><code class="language-js"><span class="hljs-comment">// xhr</span>\n  <span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();\n  xhr.withCredentials = <span class="hljs-literal">true</span>;\n  \n  <span class="hljs-comment">// fetch api</span>\n  fetch(url, {\n    <span class="hljs-attr">credentials</span>: <span class="hljs-string">"include"</span>\n  })</code></pre>\n  <p>这样一来，该跨域的ajax请求就是一个<em>附带身份凭证的请求</em></p><p>当一个请求需要附带cookie时，无论它是简单请求，还是预检请求，都会在请求头中添加<code>cookie</code>字段</p><p>而服务器响应时，需要明确告知客户端：服务器允许这样的凭据</p><p>告知的方式也非常的简单，只需要在响应头中添加：<code>Access-Control-Allow-Credentials: true</code>即可</p><p>对于一个附带身份凭证的请求，若服务器没有明确告知，浏览器仍然视为跨域被拒绝。</p><p>另外要特别注意的是：<strong>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin 的值为*</code></strong>。这就是为什么不推荐使用*的原因</p><h1 id="article-md-title-7">一个额外的补充</h1><p>在跨域访问时，JS只能拿到一些最基本的响应头，如：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma，如果要访问其他头，则需要服务器设置本响应头。</p><p><code>Access-Control-Expose-Headers</code>头让服务器把允许浏览器访问的头放入白名单，例如：</p><pre><code>Access-Control-Expose-Headers: authorization, a, b</code></pre><p>这样JS就能够访问指定的响应头了。</p>'}}),s.a.mock("/api/comment","post",{code:0,msg:"",data:{id:"@guid",nickname:"@cname",content:"@cparagraph(1, 10)",createDate:Date.now(),avatar:s.a.Random.image()}}),s.a.mock(/^\/api\/comment\/?.+$/,"get",(function(t){const e=o.a.parse(t.url);return s.a.mock({code:0,msg:"",data:{"total|52":0,["rows|"+(e.limit||10)]:[{id:"@guid",nickname:"@cname",content:"@cparagraph(1, 10)",createDate:Date.now(),avatar:s.a.Random.image()}]}})})),s.a.mock("/api/setting","get",{code:0,msg:"",data:{avatar:"https://avatars.githubusercontent.com/u/86763297?s=400&u=47b38b22da7a141b5d0f6ddeb4eb529cb7a8d759&v=4",siteTitle:"李林哲个人空间",github:"https://github.com/dashingli?tab=repositories",qq:"1120294646",qqQrCode:"http://www.duyiedu.com/source/img/%E5%B0%8F%E6%B8%A1%E5%BE%AE%E4%BF%A1%E4%BA%8C%E7%BB%B4%E7%A0%81.png",weixin:"lilinzhe123",weixinQrCode:"http://www.duyiedu.com/source/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.png",mail:"l1120294646@gmail.com",icp:"黑ICP备17001719号",githubName:"dashingli",favicon:"https://avatars.githubusercontent.com/u/86763297?s=400&u=47b38b22da7a141b5d0f6ddeb4eb529cb7a8d759&v=4"}}),s.a.mock("/api/about","get",{code:0,msg:"",data:"http://dashingli.gitee.io/resume/"}),s.a.mock("/api/project","get",{code:0,msg:"","data|10-33":[{id:"@uuid",name:"@ctitle(5,15)",url:"@url","github|1":["@url",null],"description|1-4":["@cparagraph(1)"],thumb:"@image('250x200', '#50B347', '#FFF', 'Mock.js')"}]}),s.a.mock("/api/message","post",{code:0,msg:"",data:{id:"@id",nickname:"@cname",content:"@cparagraph",createDate:Date.now(),avatar:s.a.Random.image()}}),s.a.mock(/^\/api\/message\/?(\?.+)?$/,"get",(function(t){const e=o.a.parse(t.url);return s.a.mock({code:0,msg:"",data:{total:52,["rows|"+(e.limit||10)]:[{id:"@guid",nickname:"@cname",content:"@cparagraph(1, 10)",createDate:Date.now(),avatar:s.a.Random.image()}]}})})),s.a.setup({timeout:"1000-2000"});var r=a("2b0e"),c=function(){var t=this,e=t._self._c;return e("div",{staticClass:"app-wrapper"},[e("Layout",{scopedSlots:t._u([{key:"left",fn:function(){return[e("SiteAside")]},proxy:!0},{key:"main",fn:function(){return[e("router-view")]},proxy:!0}])})],1)},l=[],p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"layout-wrapper"},[e("div",{staticClass:"left-wrapper"},[t._t("left")],2),e("div",{staticClass:"main-wrapper"},[t._t("main")],2),e("div",{staticClass:"right-wrapper"},[t._t("right")],2)])},d=[],m={},u=m,h=(a("82db"),a("2877")),g=Object(h["a"])(u,p,d,!1,null,"208f79af",null),f=g.exports,b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"site-aside-wrapper"},[e("Avater",{attrs:{url:t.$store.state.setting.data.avatar}}),e("span",{style:{color:"#b4b8bc",textAlign:"center",marginTop:"10px",fontSize:"1.1em"}},[t._v(t._s(t.$store.state.setting.data.siteTitle))]),e("Menu"),e("Contact")],1)},v=[],y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"avater-wrapper",style:{minWidth:t.width+"px",minHeight:t.width+"px"}},[e("img",{staticClass:"avatar-img",style:{width:t.width+"px",height:t.width+"px"},attrs:{src:t.url}})])},w=[],C={props:{url:{type:String,require:!0},width:{type:Number,default:150}}},_=C,x=(a("6311"),Object(h["a"])(_,y,w,!1,null,"234497e4",null)),L=x.exports,T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"menu-wrapper"},[e("router-link",{attrs:{to:{name:"home"},exact:"","active-class":"selected"}},[e("Icon",{attrs:{name:"home"}}),t._v(" 首页 ")],1),e("router-link",{attrs:{to:{name:"blog"},"active-class":"selected"}},[e("Icon",{attrs:{name:"blog"}}),t._v(" 文章 ")],1),e("router-link",{attrs:{to:{name:"about"},exact:"","active-class":"selected"}},[e("Icon",{attrs:{name:"about"}}),t._v(" 关于我 ")],1),e("router-link",{attrs:{to:{name:"project"},exact:"","active-class":"selected"}},[e("Icon",{attrs:{name:"code"}}),t._v(" 项目&效果 ")],1),e("router-link",{attrs:{to:{name:"message"},exact:"","active-class":"selected"}},[e("Icon",{attrs:{name:"chat"}}),t._v(" 留言 ")],1)],1)},k=[],j=function(){var t=this,e=t._self._c;return e("i",{staticClass:"iconfont",class:t.fontClass})},S=[];const $={home:"iconzhuye",success:"iconzhengque",error:"iconcuowu",close:"iconguanbi",warn:"iconjinggao",info:"iconxinxi",blog:"iconblog",code:"iconcode",about:"iconset_about_hov",weixin:"iconweixin",mail:"iconemail",github:"icongithub",qq:"iconsign_qq",arrowUp:"iconiconfonticonfonti2copy",arrowDown:"iconiconfonticonfonti2",empty:"iconempty",chat:"iconliuyan"};Object.keys($);var O={props:{name:{type:String,required:!0}},computed:{fontClass(){return $[this.name]}}},I=O,A=(a("eab8"),Object(h["a"])(I,j,S,!1,null,"95541244",null)),B=A.exports,D=(a("4700"),{components:{Icon:B}}),N=D,E=(a("8f2a"),Object(h["a"])(N,T,k,!1,null,"6820034f",null)),M=E.exports,q=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Contact-wrapper"},[e("a",{attrs:{href:t.$store.state.setting.data.github,target:"_blank"}},[e("Icon",{attrs:{name:"github"}}),e("span",{staticClass:"font"},[t._v(t._s(t.$store.state.setting.data.githubName))])],1),e("a",{attrs:{href:"mailto:"+t.$store.state.setting.data.mail}},[e("Icon",{attrs:{name:"mail"}}),e("span",{staticClass:"font"},[t._v(t._s(t.$store.state.setting.data.mail))])],1),e("a",[e("Icon",{attrs:{name:"qq"}}),e("span",{staticClass:"font"},[t._v(t._s(t.$store.state.setting.data.qq))])],1),e("a",[e("Icon",{attrs:{name:"weixin"}}),e("span",{staticClass:"font"},[t._v(t._s(t.$store.state.setting.data.weixin))])],1)])},P=[],H={components:{Icon:B}},R=H,W=(a("94ec"),Object(h["a"])(R,q,P,!1,null,"74bc0c10",null)),J=W.exports,F={components:{Avater:L,Menu:M,Contact:J}},z=F,G=(a("9866"),Object(h["a"])(z,b,v,!1,null,"749215fc",null)),K=G.exports,Y={components:{Layout:f,SiteAside:K}},U=Y,Q=Object(h["a"])(U,c,l,!1,null,"ecf3cc7a",null),X=Q.exports,V=a("8c4f"),Z=function(){var t=this,e=t._self._c;return e("div",{ref:"homeWrapper",staticClass:"home-wrapper"},[e("div",{staticClass:"banner-wrapper"},t._l(t.bannerList,(function(a,n){return e("div",{key:n,staticClass:"banner-item",style:{marginTop:0===n?t.caculMarginTop+"px":"0px"}},[e("div",{staticClass:"title-wrapper",style:{top:n*t.wrapperHeight+t.wrapperHeight/2+"px"}},[e("h1",{ref:"titleRef",refInFor:!0},[t._v(" "+t._s(a.title)+" ")]),e("h2",{ref:"descRef",refInFor:!0},[t._v(t._s(a.description))])]),e("ImageLoader",{staticClass:"image-loader",attrs:{src:a.bigImg,placeholder:a.midImg}})],1)})),0),e("div",{directives:[{name:"show",rawName:"v-show",value:t.index>1,expression:"index > 1"}],staticClass:"uparrow-wrapper",on:{click:function(e){return t.indexChanged(t.index-1)}}},[e("Icon",{attrs:{name:"arrowUp"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.index<t.bannerList.length,expression:"index < bannerList.length"}],staticClass:"arrowdown-wrapper",on:{click:function(e){return t.indexChanged(t.index+1)}}},[e("Icon",{attrs:{name:"arrowDown"}})],1),e("div",{staticClass:"index-wrapper"},[e("ul",{on:{transitionend:t.handleTransitionEnd}},t._l(t.bannerList,(function(a,n){return e("li",{key:a.id,class:{active:n===t.index-1},on:{click:function(e){return t.indexChanged(n+1)}}})})),0)]),e("Message",{attrs:{isShow:t.isMessage,duration:t.duration,mesType:t.mesType,msgContent:t.msgContent}})],1)},tt=[],et=function(){var t=this,e=t._self._c;return e("div",[e("transition",{attrs:{"enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[t.isShow?e("div",{staticClass:"message-wrapper",class:{success:t.msgSucStyle,info:t.msgInfoStyle,warn:t.msgWarnStyle,error:t.msgErrorStyle}},[e("Icon",{attrs:{name:t.mesType}}),e("span",[t._v(t._s(t.msgContent))])],1):t._e()])],1)},at=[],nt={props:{mesType:{type:String,default:"success"},msgContent:{type:String,default:"消息成功"},duration:{type:Number,required:!0},isShow:{type:Boolean}},computed:{msgSucStyle(){return"success"===this.mesType},msgInfoStyle(){return"info"===this.mesType},msgWarnStyle(){return"warn"===this.mesType},msgErrorStyle(){return"error"===this.mesType}},components:{Icon:B}},st=nt,it=(a("b08c"),Object(h["a"])(st,et,at,!1,null,"2cd4e8ae",null)),ot=it.exports,rt=a("4800");const ct=rt["a"].create();async function lt(){return await ct.get("/api/banner")}ct.interceptors.response.use((function(t){return 0===t.data.code&&t.data}));var pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-loader-wrapper"},[t.isEveryThingDone?t._e():e("img",{staticClass:"placeholder",attrs:{src:t.placeholder}}),e("img",{style:{opacity:t.isOriginOpt,transition:t.duration+"ms"},attrs:{src:t.src},on:{load:t.handleLoad}})])},dt=[],mt={props:{src:{type:String,required:!0},placeholder:{type:String,required:!0},duration:{type:Number,default:1e3}},data(){return{isOrigin:!1,isEveryThingDone:!1}},computed:{isOriginOpt(){return this.isOrigin?1:0}},methods:{handleLoad(){this.isOrigin=!0,setTimeout(()=>{this.isEveryThingDone=!0,this.$emit("handleImage")},this.duration)}}},ut=mt,ht=(a("3b9e"),Object(h["a"])(ut,pt,dt,!1,null,"e09f5bfa",null)),gt=ht.exports,ft={computed:{caculMarginTop(){return-(this.index-1)*this.wrapperHeight}},mounted(){this.wrapperHeight=this.$refs.homeWrapper.clientHeight,window.addEventListener("wheel",this.wheelChanged),window.addEventListener("resize",this.resizeChanged)},destroyed(){window.removeEventListener("wheel",this.wheelChanged),clearTimeout(this.timeout)},data(){return{isMessage:!1,duration:1e3,mesType:"success",msgContent:"获取消息成功",bannerList:[],index:1,wrapperHeight:0,isWheel:!1,marginTop:0,titleWidth:0,descWidth:0,timeId:void 0}},methods:{wheelChanged(t){this.isWheel||(t.deltaY<-5&&this.index>1?(this.isWheel=!0,this.index=this.index-1):t.deltaY>5&&this.index<this.bannerList.length&&(this.isWheel=!0,this.index=this.index+1))},handleTransitionEnd(){this.isWheel=!1},indexChanged(t){this.index=t},resizeChanged(){this.wrapperHeight=this.$refs.homeWrapper.clientHeight}},components:{Message:ot,Icon:B,ImageLoader:gt},async created(){const t=await lt();0!==t.code?(this.mesType="error",this.msgContent="获取消息失败"):(this.mesType="success",this.msgContent="获取消息成功",this.bannerList=t.data,this.$nextTick((function(){this.titleWidth=this.$refs.titleRef[0].clientWidth,this.$refs.titleRef[0].style.width="0px",this.$refs.titleRef[0].clientHeight,this.$refs.titleRef[0].style.width=this.titleWidth+"px",this.descWidth=this.$refs.descRef[0].clientWidth,this.$refs.descRef[0].style.width="0px",this.timeId=setTimeout(()=>{this.$refs.descRef[0].clientHeight,this.$refs.descRef[0].style.width=this.descWidth+"px"},1500)}))),this.isMessage=!0,setTimeout(()=>this.isMessage=!1,this.duration)}},bt=ft,vt=(a("80c7"),Object(h["a"])(bt,Z,tt,!1,null,"14ddfa06",null)),yt=vt.exports,wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"blog-wrapper"},[e("Layout",{scopedSlots:t._u([{key:"main",fn:function(){return[e("div",{ref:"blogWrapper",staticClass:"main-wrapper"},[e("blogList")],1)]},proxy:!0},{key:"right",fn:function(){return[e("div",{staticClass:"right-wrapper"},[e("BlogCategory")],1)]},proxy:!0}])})],1)},Ct=[],_t=function(){var t=this,e=t._self._c;return e("div",{staticClass:"BlogCategory-wrapper"},[e("h2",[t._v("文章分类")]),e("rightList",{attrs:{dataList:t.list},on:{handleClick:t.handleClick}}),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"loading-img",attrs:{src:a("4045"),alt:""}})],1)},xt=[],Lt=(a("14d9"),a("13d5"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"rightList-wrapper"},[e("ul",t._l(t.dataList,(function(a,n){return e("li",{key:n},[e("span",{staticClass:"name-item",class:{select:a.select},on:{click:function(e){return t.handleClick(a)}}},[t._v(t._s(a.name))]),a.aside?e("span",{staticClass:"aside-item",class:{select:a.select},on:{click:function(e){return t.handleClick(a)}}},[t._v(" "+t._s(a.aside)+" ")]):t._e(),e("rightList",{attrs:{dataList:a.children},on:{handleClick:t.handleClick}})],1)})),0)])}),Tt=[],kt={name:"rightList",methods:{handleClick(t){this.$emit("handleClick",t)}},props:{dataList:{type:Array,default:()=>[]}}},jt=kt,St=(a("88f6"),Object(h["a"])(jt,Lt,Tt,!1,null,"6e6777f3",null)),$t=St.exports;async function Ot(){return await ct.get("/api/blogtype")}async function It(t=1,e=10,a=-1){return await ct.get("/api/blog",{params:{page:t,limit:e,categoryid:a,keyword:""}})}async function At(t){return await ct.get("/api/blog/"+t)}async function Bt(t){return await ct.post("/api/comment",{data:t})}async function Dt(t=-1,e=10,a=-1){return await ct.get("/api/comment",{params:{page:t,limit:e,blogid:a}})}var Nt={methods:{handleClick(t){if(this.cateId===t.id)return;const e={page:1,limit:this.limit};-1===t.id?this.$router.push({name:"blog",query:e}):this.$router.push({name:"blogCategory",query:e,params:{categoryId:t.id}})}},computed:{cateId(){return+this.$route.params.categoryId||-1},limit(){return+this.$route.query.limit||10},list(){const t=this.data.reduce((t,e)=>t+e.articleCount,0),e=[{articleCount:t,id:-1,name:"全部文章"},...this.data];return e.map(t=>({select:t.id===this.cateId,aside:t.articleCount+"篇",...t}))}},data(){return{data:[],isLoading:!0}},components:{rightList:$t},async created(){const t=await Ot();this.data=t.data,this.isLoading=!1}},Et=Nt,Mt=(a("e5e8"),Object(h["a"])(Et,_t,xt,!1,null,"4f7de720",null)),qt=Mt.exports,Pt=function(){var t=this,e=t._self._c;return e("div",{ref:"wrapper",staticClass:"blogList-wrapper"},[e("ul",[t._l(t.blogList.data.rows,(function(a){return e("li",{key:a.id},[e("router-link",{attrs:{to:{name:"BlogDetail",params:{id:a.id}}}},[e("div",{staticClass:"image-items-wrapper"},[null!==a.thumb?e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.thumb,expression:"blog.thumb"}],attrs:{alt:""}}):t._e()])]),e("div",{staticClass:"title-wrapper"},[e("router-link",{attrs:{to:{name:"BlogDetail",params:{id:a.id}},"active-class":"active-link"}},[e("h2",[t._v(" "+t._s(a.title)+" ")])]),e("div",{staticClass:"content-wrapper"},[e("span",[t._v("日期："+t._s(t.getDate(a.createDate)))]),e("span",[t._v("浏览："+t._s(a.scanNumber))]),e("router-link",{attrs:{to:{name:"BlogDetail",params:{id:a.id}}}},[e("span",[t._v("评论："+t._s(a.commentNumber))])]),e("span",[t._v(t._s(a.category.name))])],1),e("p",[t._v(" "+t._s(a.description)+" ")])],1)],1)})),0!==t.blogList.data.rows.length?e("Pager",{attrs:{current:t.routeInfo.page,total:t.blogList.data.total},on:{changeCurrent:t.handleChangeCurrent,changeJump:t.handleChangeJump}}):t._e()],2),0===t.blogList.data.rows.length&&!1===t.isLoading?e("Empty"):t._e(),e("img",{directives:[{name:"show",rawName:"v-show",value:t.isLoading,expression:"isLoading"}],staticClass:"loading",attrs:{src:a("4045"),alt:""}}),e("Top",{directives:[{name:"show",rawName:"v-show",value:t.isTop,expression:"isTop"}]})],1)},Ht=[],Rt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pager-wrapper"},[e("a",{class:{disabled:1===t.current},on:{click:function(e){return t.changeCurrent(1)}}},[t._v("首页")]),e("a",{class:{disabled:1===t.current},on:{click:function(e){return t.changeCurrent(t.current-1)}}},[t._v("上一页")]),t._l(t.numbers,(function(a,n){return e("a",{key:n,class:{active:t.current===a},on:{click:function(e){return t.changeCurrent(a)}}},[t._v(t._s(a))])})),e("a",{class:{disabled:t.current===t.calculatePage},on:{click:function(e){return t.changeCurrent(t.current+1)}}},[t._v("下一页")]),e("a",{class:{disabled:t.current===t.calculatePage},on:{click:function(e){return t.changeCurrent(t.calculatePage)}}},[t._v("末尾")]),e("div",{staticClass:"jump-wrapper"},[e("span",[t._v("共"+t._s(t.calculatePage)+"页,到第")]),e("input",{ref:"jumpNumber",attrs:{type:"number",max:t.calculatePage,min:1}}),e("span",[t._v("页")])]),e("a",{on:{click:t.clickJump}},[t._v("跳转")])],2)},Wt=[],Jt={props:{current:{type:Number,required:!0},total:{type:Number,required:!0},pageTotal:{type:Number,default:10},visibleNumber:{type:Number,default:5}},computed:{calculatePage(){return Math.ceil(this.total/this.pageTotal)},visibleMin(){let t=this.current-Math.ceil(this.visibleNumber/2);return t<1&&(t=1),t},visibleMax(){let t=this.visibleMin+this.visibleNumber-1;return t>this.calculatePage&&(t=this.calculatePage),t},numbers(){let t=[];for(let e=this.visibleMin;e<=this.visibleMax;e++)t.push(e);return t}},methods:{changeCurrent(t){0!==t&&(t>this.calculatePage||t!==this.current&&this.$emit("changeCurrent",t))},clickJump(){const t=parseInt(this.$refs.jumpNumber.value);t<1||t>this.calculatePage||this.$emit("changeJump",t)}}},Ft=Jt,zt=(a("7ef1"),Object(h["a"])(Ft,Rt,Wt,!1,null,"895b34fc",null)),Gt=zt.exports,Kt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"top-wrapper",on:{click:t.TopButtonHandle}},[t._m(0)])},Yt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"round-wrapper"},[e("span",[t._v("Top")])])}],Ut={methods:{TopButtonHandle(){this.$bus.$emit("TopButtonHandle","来自页面的消息")}}},Qt=Ut,Xt=(a("27b7"),Object(h["a"])(Qt,Kt,Yt,!1,null,"02147951",null)),Vt=Xt.exports;function Zt(t,e){let a=null;return(...n)=>{a&&clearTimeout(a),a=setTimeout(()=>{t(...n)},e)}}var te=function(){return{data(){return{isTop:!1}},mounted(){this.$bus.$on("TopButtonHandle",this.scrollToTop),this.setDebounce=Zt(this.scrollCheck,500),this.$refs.wrapper.addEventListener("scroll",this.setDebounce)},beforeDestroy(){this.$refs.wrapper.removeEventListener("scroll",this.setDebounce)},methods:{scrollToTop(){void 0!==this.$refs.wrapper&&(this.$refs.wrapper.scrollTop=0)},scrollCheck(){this.$refs.wrapper.scrollTop>200?this.isTop=!0:this.isTop=!1}}}},ee=function(){var t=this,e=t._self._c;return e("div",{staticClass:"empty-text-wrapper"},[e("Icon",{attrs:{name:"empty"}}),e("span",[t._v(t._s(t.text))])],1)},ae=[],ne={components:{Icon:B},props:{text:{type:String,default:"无数据"}}},se=ne,ie=(a("1b18"),Object(h["a"])(se,ee,ae,!1,null,"0a3a9972",null)),oe=ie.exports,re={mixins:[te()],computed:{routeInfo(){const t=+this.$route.query.page||1,e=+this.$route.query.limit||10,a=+this.$route.params.categoryId||-1;return{page:t,limit:e,categoryId:a}}},components:{Pager:Gt,Top:Vt,Empty:oe},data(){return{isLoading:!0,blogList:{data:{rows:[],total:0}}}},watch:{async $route(){this.$refs.wrapper.scrollTop=0,this.isLoading=!0,this.blogList=await It(this.routeInfo.page,this.routeInfo.limit,this.routeInfo.categoryId),this.isLoading=!1}},methods:{getDate(t){const e=new Date(+t),a=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0");return`${a}-${n}-${s}`},handleChangeCurrent(t){const e={page:t,limit:this.routeInfo.limit};-1===this.routeInfo.categoryId?this.$router.push({name:"blog",query:e}):this.$router.push({name:"blogCategory",params:{categoryId:this.routeInfo.categoryId},query:e})},handleChangeJump(t){const e={page:t,limit:this.routeInfo.limit};-1===this.routeInfo.categoryId?this.$router.push({name:"blog",query:e}):this.$router.push({name:"blogCategory",params:{categoryId:this.routeInfo.categoryId},query:e})}},async created(){this.blogList=await It(this.routeInfo.page,this.routeInfo.limit,this.routeInfo.categoryId),this.isLoading=!1}},ce=re,le=(a("bee7"),Object(h["a"])(ce,Pt,Ht,!1,null,"1575baa1",null)),pe=le.exports,de={components:{Layout:f,BlogCategory:qt,blogList:pe}},me=de,ue=Object(h["a"])(me,wt,Ct,!1,null,"56f6eeb0",null),he=ue.exports,ge=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"about-wrapper"},[t.getSrc?e("iframe",{staticClass:"iframe-wrapper",attrs:{src:t.getSrc},on:{load:function(e){t.isLoading=!1}}}):t._e()])},fe=[],be=a("4045"),ve=a.n(be),ye={computed:{getSrc(){return this.$store.state.about.src}},data(){return{isLoading:!0}},directives:{loading:{bind:function(t,e){if(e.value){const e=document.createElement("img");e.src=ve.a,e.className="loading",t.appendChild(e)}},update:function(t,e){if(!e.value){const t=document.querySelector(".loading");t&&t.remove()}}}},async created(){console.log("Created"),await this.$store.dispatch("about/about")}},we=ye,Ce=(a("a692"),Object(h["a"])(we,ge,fe,!1,null,"52c37ed3",null)),_e=Ce.exports,xe=function(){var t=this,e=t._self._c;return e("div",{ref:"wrapper",staticClass:"message-wrapper"},[0!==t.commentList.length?e("MessageArea",{attrs:{commentTotal:t.commentTotal,commentList:t.commentList,title:"留言板",type:2},on:{submit:t.handleSubmit}}):t._e(),t.isLoading?e("img",{attrs:{src:a("4045")}}):t._e(),e("Top",{directives:[{name:"show",rawName:"v-show",value:t.isTop,expression:"isTop"}]})],1)},Le=[],Te=(a("3c65"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"message-area-wrapper"},[e("div",{staticClass:"form-wrapper"},[e("Form",{attrs:{type:t.type},on:{submit:t.handleSubmit}})],1),e("div",{staticClass:"comment-list-wrapper"},[0!==t.commentList.length?e("CommentList",{attrs:{title:t.title,commentTotal:t.commentTotal,commentList:t.commentList}}):t._e()],1)])}),ke=[],je=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-wrapper"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("div",{staticClass:"input-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.formBody.nickname,expression:"formBody.nickname"}],attrs:{type:"text",placeholder:"用户昵称",maxlength:"10"},domProps:{value:t.formBody.nickname},on:{input:function(e){e.target.composing||t.$set(t.formBody,"nickname",e.target.value)}}}),e("span",{staticClass:"nick-name-span",class:{maxColor:t.formBody.nickname.length>=10}},[t._v(t._s(t.formBody.nickname.length)+"/10")])]),e("span",{staticClass:"nick-name-error"},[t._v(t._s(t.nickNameError))]),e("div",{staticClass:"textarea-wrapper"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formBody.content,expression:"formBody.content"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"请输入内容",maxlength:"300"},domProps:{value:t.formBody.content},on:{input:function(e){e.target.composing||t.$set(t.formBody,"content",e.target.value)}}}),e("span",{staticClass:"content-wrapper",class:{maxColor:t.formBody.content.length>=300}},[t._v(" "+t._s(t.formBody.content.length)+"/300 ")])]),e("span",{staticClass:"content-error"},[t._v(t._s(t.contentError))]),e("button",{ref:"submitButton",class:{isSubmit:t.isSubmit}},[t._v(" "+t._s(t.isSubmit?"正在提交..":"提交")+" ")])]),!0===t.isLoading?e("img",{attrs:{src:a("4045")}}):t._e(),e("Message",{attrs:{mesType:t.mesType,msgContent:t.msgContent,isShow:t.isMessage,duration:t.duration}})],1)},Se=[];async function $e(t){return await ct.post("/api/message",{data:t})}async function Oe(t=1,e=10){return await ct.get("/api/message",{params:{page:t,limit:e}})}var Ie={components:{Message:ot},props:{type:{type:Number,required:!0}},data(){return{formBody:{nickname:"",content:"",blogId:this.$route.params.id},nickNameError:"",contentError:"",isLoading:!1,isMessage:!1,duration:1e3,mesType:"success",msgContent:"评论成功",isSubmit:!1}},methods:{async onSubmit(){if(this.formBody.nickname||(this.nickNameError="请输入用户名"),this.formBody.content||(this.contentError="请输入内容"),!this.formBody.nickname||!this.formBody.content)return;let t;this.$refs.submitButton.disabled=!0,this.isLoading=!0,this.isSubmit=!0,1===this.type&&(t=await Bt(this.formBody)),2===this.type&&(t=await $e(this.formBody));const e=t.data;this.isMessage=!0,0===t.code?this.$emit("submit",e):(this.mesType="error",this.msgContent="未知错误,评论失败"),this.formBody.nickname="",this.formBody.content="",this.isLoading=!1,this.isSubmit=!1,this.$refs.submitButton.disabled=!1,setTimeout(()=>this.isMessage=!1,this.duration)}}},Ae=Ie,Be=(a("fdfa"),Object(h["a"])(Ae,je,Se,!1,null,"106f2fe6",null)),De=Be.exports,Ne=function(){var t=this,e=t._self._c;return e("div",{staticClass:"comment-list-wrapper"},[e("div",{staticClass:"comment-title"},[e("span",[t._v(t._s(t.title))]),e("span",[t._v("("+t._s(t.commentTotal)+")")])]),t._l(t.commentList,(function(a){return e("div",{key:a.id,staticClass:"comment"},[e("Avater",{attrs:{url:a.avatar,width:50}}),e("div",{staticClass:"comment-conent"},[e("div",{staticClass:"name-date-wrapper"},[e("div",{staticClass:"name"},[e("span",[t._v(t._s(a.nickname))])]),e("div",{staticClass:"date"},[e("span",[t._v(t._s(t.dateFormat(a.createDate,!0)))])])]),e("div",{staticClass:"comment-main"},[e("span",[t._v(t._s(a.content))])])])],1)}))],2)},Ee=[];function Me(t,e=!1){const a=new Date(+t),n=a.getFullYear(),s=(a.getMonth()+1).toString().padStart(2,"0"),i=a.getDate().toString().padStart(2,"0"),o=a.getHours().toString().padStart(2,"0"),r=a.getMinutes().toString().padStart(2,"0"),c=a.getSeconds().toString().padStart(2,"0");return e?`${n}-${s}-${i} ${o}:${r}:${c}`:`${n}-${s}-${i}`}var qe={methods:{dateFormat:Me},props:{commentList:{type:Array,default:()=>[]},title:{type:String,required:!0},commentTotal:{type:Number,required:!0}},components:{Avater:L}},Pe=qe,He=(a("42a1"),Object(h["a"])(Pe,Ne,Ee,!1,null,"4ad9caaa",null)),Re=He.exports,We={methods:{handleSubmit(t){this.$emit("submit",t)}},components:{Form:De,CommentList:Re},props:{commentTotal:{type:Number,required:!0},commentList:{type:Array,default:()=>[]},type:{type:Number,required:!0},title:{type:String,required:!0}}},Je=We,Fe=Object(h["a"])(Je,Te,ke,!1,null,"50d9ee7a",null),ze=Fe.exports,Ge={mixins:[te()],data(){return{commentTotal:0,commentList:[],page:1,limit:10,isLoading:!1}},components:{MessageArea:ze,Top:Vt},computed:{totalPages(){return Math.ceil(this.commentTotal/this.limit)}},methods:{handleSubmit(t){this.commentList.unshift(t),this.commentTotal++},handleScroll(){this.$bus.$emit("mainScroll",this.$refs.wrapper)},async getNewComments(){if(this.page>=this.totalPages)return;this.isLoading=!0,this.page++;const t=await Oe(this.page,this.limit,this.$route.params.id),e=t.data;this.commentList=this.commentList.concat(e.rows),this.commentTotal=e.total,this.isLoading=!1},scrollEnd(){const t=this.$refs.wrapper,e=Math.ceil(t.scrollTop),a=Math.ceil(t.clientHeight),n=Math.ceil(t.scrollHeight);e+a===n&&this.getNewComments()}},async created(){const t=await Oe(this.page,this.limit,this.$route.params.id),e=t.data;this.commentList=e.rows,this.commentTotal=e.total,window.getNewComments=this.getNewComments},mounted(){this.setDeBounce=Zt(this.handleScroll,50),this.$refs.wrapper.addEventListener("scroll",this.scrollEnd),this.$refs.wrapper.addEventListener("scroll",this.setDeBounce)},beforeDestroy(){this.$refs.wrapper.removeEventListener("scroll",this.scrollEnd),this.$refs.wrapper.removeEventListener("scroll",this.setDeBounce)}},Ke=Ge,Ye=(a("0bb0"),Object(h["a"])(Ke,xe,Le,!1,null,"3cfa253b",null)),Ue=Ye.exports,Qe=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"wrapper",staticClass:"project-wrapper"},[e("ul",{staticClass:"list-wrapper"},t._l(t.$store.state.demo.data,(function(a){return e("li",{key:a.id,staticClass:"item-wrapper"},[e("a",{staticClass:"img-wrapper"},[null!==a.thumb?e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:a.thumb,expression:"i.thumb"}]}):t._e()]),e("div",{staticClass:"desc-wrapper"},[e("h2",[t._v(" "+t._s(a.name))]),null!==a.github?e("a",{attrs:{href:a.github}},[t._v("github")]):t._e(),t._l(a.description,(function(a,n){return e("p",{key:n.id},[t._v(t._s(a))])}))],2)])})),0),t.isTop?e("Top"):t._e()],1)},Xe=[],Ve={mixins:[te()],created(){this.$store.dispatch("demo/getDate")},components:{Top:Vt},computed:{isLoading(){return this.$store.state.demo.isLoading}},directives:{loading:{bind:function(t,e){if(e.value){const e=document.createElement("img");e.src=ve.a,e.className="loading",t.appendChild(e)}},update:function(t,e){if(!e.value){const t=document.querySelector(".loading");t&&t.remove()}}}}},Ze=Ve,ta=(a("da94"),Object(h["a"])(Ze,Qe,Xe,!1,null,"5b7a2be6",null)),ea=ta.exports,aa=function(){var t=this,e=t._self._c;return e("div",{ref:"container",staticClass:"detail-wrapper"},[e("Layout",{scopedSlots:t._u([{key:"main",fn:function(){return[0!==Object.keys(t.data).length?e("BlogContent",{attrs:{data:t.data}}):t._e()]},proxy:!0},{key:"right",fn:function(){return[0!==Object.keys(t.data).length?e("rightList",{attrs:{dataList:t.selectMap},on:{handleClick:t.handleClick}}):t._e()]},proxy:!0}])})],1)},na=[],sa=function(){var t=this,e=t._self._c;return e("div",{ref:"wrapper",staticClass:"blogContent-wrapper markdown-body"},[e("h2",[t._v(t._s(t.data.title))]),e("span",[t._v("日期:"+t._s(t.dateFormat(t.data.createDate)))]),e("span",[t._v("浏览:"+t._s(t.data.scanNumber))]),e("a",{attrs:{href:"#commentList"}},[e("span",[t._v("评论:"+t._s(t.data.commentNumber))])]),e("router-link",{attrs:{to:{name:"blogCategory",params:{categoryId:t.data.category.id}}}},[e("span",[t._v(t._s(t.data.category.name))])]),e("div",{staticClass:"main-content-wrapper",domProps:{innerHTML:t._s(t.data.htmlContent)}}),0!==t.commentList.length?e("MessageArea",{attrs:{title:"评论列表",id:"commentList",commentTotal:t.commentTotal,commentList:t.commentList,type:1},on:{submit:t.handleSubmit}}):t._e(),t.isLoading?e("img",{attrs:{src:a("4045")}}):t._e(),e("Top",{directives:[{name:"show",rawName:"v-show",value:t.isTop,expression:"isTop"}]})],1)},ia=[],oa=(a("0a38"),a("131f"),{mixins:[te()],methods:{handleSubmit(t){this.commentList.unshift(t),this.commentTotal++},dateFormat:Me,handleScroll(){this.$bus.$emit("mainScroll",this.$refs.wrapper)},async getNewComments(){if(this.page>=this.totalPages)return;this.isLoading=!0,this.page++;const t=await Dt(this.page,this.limit,this.$route.params.id),e=t.data;this.commentList=this.commentList.concat(e.rows),this.commentTotal=e.total,this.isLoading=!1},scrollEnd(){const t=this.$refs.wrapper,e=Math.ceil(t.scrollTop),a=Math.ceil(t.clientHeight),n=Math.ceil(t.scrollHeight);e+a===n&&this.getNewComments()}},computed:{totalPages(){return Math.ceil(this.commentTotal/this.limit)}},async created(){const t=await Dt(this.page,this.limit,this.$route.params.id),e=t.data;this.commentList=e.rows,this.commentTotal=e.total,window.getNewComments=this.getNewComments},mounted(){this.setDeBounce=Zt(this.handleScroll,50),this.$refs.wrapper.addEventListener("scroll",this.scrollEnd),this.$refs.wrapper.addEventListener("scroll",this.setDeBounce)},beforeDestroy(){this.$refs.wrapper.removeEventListener("scroll",this.scrollEnd),this.$refs.wrapper.removeEventListener("scroll",this.setDeBounce)},data(){return{commentTotal:0,commentList:[],page:1,limit:10,isLoading:!1}},components:{MessageArea:ze,Top:Vt},props:{data:{type:Object,required:!0}}}),ra=oa,ca=(a("e52a"),Object(h["a"])(ra,sa,ia,!1,null,"65057e06",null)),la=ca.exports,pa={components:{Layout:f,BlogContent:la,rightList:$t},data(){return{data:{},activeAnchor:""}},methods:{handleClick(t){location.hash=t.anchor,this.activeAnchor=t.anchor},setSelect(){this.activeAnchor="";const t=200;for(const e of this.doms){if(!e)continue;const a=e.getBoundingClientRect().top;if(a<=t&&a>0)return void(this.activeAnchor=e.id);if(a>t)return;this.activeAnchor=e.id}}},computed:{selectMap(){const t=(e=[])=>e.map(e=>({...e,select:e.anchor===this.activeAnchor,children:t(e.children)}));return t(this.data.toc)},doms(){const t=[],e=a=>{for(const n of a)t.push(document.querySelector("#"+n.anchor)),n.children&&n.children.length>0&&e(n.children)};return e(this.data.toc),t}},async created(){const t=this.$route.params.id,e=await At(t);this.data=e.data,this.$bus.$on("mainScroll",this.setSelect)}},da=pa,ma=Object(h["a"])(da,aa,na,!1,null,"b4ce199a",null),ua=ma.exports,ha=a("2f62"),ga={namespaced:!0,state:{isLoading:!0,apiData:[]},mutations:{setLoading(t,e){t.isLoading=e},setData(t,e){t.apiData=e}},actions:{async getBanner(t){if(0!==t.state.apiData.length)return;t.commit("setLoading",!0);const e=await lt(),a=e.data;return t.commit("setData",a),t.commit("setLoading",!1),e}}};async function fa(){return await ct.get("/api/setting")}var ba={namespaced:!0,state:{data:{}},mutations:{setDate(t,e){t.data=e}},actions:{async getDate(t){const e=await fa();if(t.commit("setDate",e.data),e.data.favicon){const t=document.createElement("link");t.rel="shortcut icon",t.href=e.data.favicon,t.type="image/x-icon",document.querySelector("head").appendChild(t)}}}};async function va(){return ct.get("/api/about")}var ya={namespaced:!0,state:{loading:!1,src:""},mutations:{setLoading(t,e){t.loading=e},setSrc(t,e){t.src=e}},actions:{async about(t){if(t.state.src)return;t.commit("setLoading",!0);const e=await va();t.commit("setSrc",e.data),t.commit("setLoading",!1)}}};async function wa(){return await ct.get("/api/project")}var Ca={namespaced:!0,state:{data:[],isLoading:!1},mutations:{setDate(t,e){t.data=e},setLoading(t,e){t.isLoading=e}},actions:{async getDate(t){if(0!==t.state.data.length)return;t.commit("setLoading",!0);const e=await wa(),a=e.data;t.commit("setDate",a),t.commit("setLoading",!1)}}};r["a"].use(ha["a"]);const _a=new ha["a"].Store({strict:!0,modules:{banner:ga,setting:ba,about:ya,demo:Ca}});var xa=_a,La=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notfound-wrapper"},[e("img",{attrs:{src:a("463f"),alt:""}}),e("router-link",{staticClass:"button",attrs:{to:"/Blog"}},[e("span",{staticClass:"text"},[t._v("GO BACK HOME")])])],1)},Ta=[],ka={},ja=ka,Sa=(a("17dd"),Object(h["a"])(ja,La,Ta,!1,null,"46bdfa35",null)),$a=Sa.exports;r["a"].use(V["a"]);const Oa=[{path:"/home",name:"home",component:yt,meta:{title:"首页"}},{path:"/blog",name:"blog",component:he,meta:{title:"博客"}},{path:"/blog/category/:categoryId",name:"blogCategory",component:he,meta:{title:"博客"}},{path:"/blog/:id",name:"BlogDetail",component:ua,meta:{title:"博客"}},{path:"/about",name:"about",component:_e,meta:{title:"关于我"}},{path:"/message",name:"message",component:Ue,meta:{title:"留言"}},{path:"/project",name:"project",component:ea,meta:{title:"项目效果"}},{path:"/",redirect:{name:"home"}},{path:"*",component:$a}],Ia=new V["a"]({routes:Oa,mode:"hash"});Ia.afterEach(t=>{const e=document.querySelector("title"),a=xa.state.setting.data.siteTitle||"个人空间";console.log(a),e.innerText=`${a} ${t.meta.title}`});var Aa=Ia,Ba=a("77ed"),Da=a.n(Ba),Na=a("caf9");r["a"].prototype.$bus=new r["a"]({}),xa.dispatch("setting/getDate"),r["a"].use(Da.a);const Ea=a("4174");r["a"].use(Na["a"],{preLoad:1.3,loading:Ea,attempt:1}),window.vm=new r["a"]({store:xa,render:t=>t(X),router:Aa}).$mount("#app")},6184:function(t,e,a){},6311:function(t,e,a){"use strict";a("cc05")},"6e81":function(t,e,a){},"72f5":function(t,e,a){},"7ef1":function(t,e,a){"use strict";a("0f35")},"80c7":function(t,e,a){"use strict";a("72f5")},"82db":function(t,e,a){"use strict";a("b3d1")},8599:function(t,e,a){},"88f6":function(t,e,a){"use strict";a("8599")},"8d72":function(t,e,a){},"8f2a":function(t,e,a){"use strict";a("c777")},"94ec":function(t,e,a){"use strict";a("8d72")},9866:function(t,e,a){"use strict";a("6184")},a2e8:function(t,e,a){},a692:function(t,e,a){"use strict";a("4bba")},b08c:function(t,e,a){"use strict";a("536b")},b2f7:function(t,e,a){},b3d1:function(t,e,a){},b7a0:function(t,e,a){},bee7:function(t,e,a){"use strict";a("dbab")},bfad:function(t,e,a){},c777:function(t,e,a){},cc05:function(t,e,a){},da94:function(t,e,a){"use strict";a("0c19")},dbab:function(t,e,a){},e52a:function(t,e,a){"use strict";a("ff7e")},e5e8:function(t,e,a){"use strict";a("b2f7")},eab8:function(t,e,a){"use strict";a("0464")},fdfa:function(t,e,a){"use strict";a("b7a0")},ff7e:function(t,e,a){}});
//# sourceMappingURL=app.2e3779e8.js.map